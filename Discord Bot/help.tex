Suppose $I$ is the set of recent numbers bet by users. If $|I| > 50,$ then $I$ is reset to a single random integer in $[1, 1000].$ Suppose $B$ is the current user's bet. A number $P$ is generated. If $B$ is not a prime, there is a 50 percent chance that $P$ is the closest prime smaller/larger than $B$ (unless $B=1$ or $B > 997$ - only one direction is available in that case). We then have $$\text{Score} = \left( \prod_{i \nmid P \in I} i^{-1} \pmod{P} \right) \pmod{P}.$$ After score calculation, $B$ is added to $I.$
